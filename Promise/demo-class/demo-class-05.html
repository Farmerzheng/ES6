<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>ajax请求的promise封装</title>
</head>

<body>
    <script>
        // ajax请求的promise封装

        function ajax(url) {
            return new Promise((resolve, reject) => {
                // 网络请求的逻辑
                const xhr = new XMLHttpRequest();
                // 客户端与服务器之间数据交互的方法 GET、POST
                // GET 方法的参数会拼接在网址的后面
                // POST  方法的参数放在了请求体里面，提交较大的数据
                xhr.open("GET", url);

                xhr.onreadystatechange = function() {

                    if (this.readyState !== 4) {
                        return;
                    }
                    if (this.status === 200) {
                        // 将promise的状态改为resolved，并将拿到的数据传递出去
                        resolve(this.response);
                    } else {
                        // 将promise的状态改成rejected，并将错误信息传递出去
                        reject(new Error(this.statusText));
                    }
                };
                xhr.send();

            })
        }

        //请求成功的回调
        // 方法一
        ajax("./post.json").then((res) => {
                console.log(res);
            }, (error) => {
                console.log(error);
            })
            // 方法二
        ajax("./post.json").then((res) => {
                //promise对象由pending-->resolved状态会执行
            })
            .catch((error) => {
                //promise对象由pending-->rejected状态会执行}) 
            })
    </script>
</body>

</html>